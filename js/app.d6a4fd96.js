(function(e){function t(t){for(var r,l,o=t[0],c=t[1],s=t[2],u=0,p=[];u<o.length;u++)l=o[u],Object.prototype.hasOwnProperty.call(n,l)&&n[l]&&p.push(n[l][0]),n[l]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);d&&d(t);while(p.length)p.shift()();return i.push.apply(i,s||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],r=!0,l=1;l<a.length;l++){var c=a[l];0!==n[c]&&(r=!1)}r&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var r={},n={app:0},i=[];function l(e){return o.p+"js/"+({about:"about"}[e]||e)+"."+{about:"6578affb"}[e]+".js"}function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.e=function(e){var t=[],a=n[e];if(0!==a)if(a)t.push(a[2]);else{var r=new Promise((function(t,r){a=n[e]=[t,r]}));t.push(a[2]=r);var i,c=document.createElement("script");c.charset="utf-8",c.timeout=120,o.nc&&c.setAttribute("nonce",o.nc),c.src=l(e);var s=new Error;i=function(t){c.onerror=c.onload=null,clearTimeout(u);var a=n[e];if(0!==a){if(a){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;s.message="Loading chunk "+e+" failed.\n("+r+": "+i+")",s.name="ChunkLoadError",s.type=r,s.request=i,a[1](s)}n[e]=void 0}};var u=setTimeout((function(){i({type:"timeout",target:c})}),12e4);c.onerror=c.onload=i,document.head.appendChild(c)}return Promise.all(t)},o.m=e,o.c=r,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(a,r,function(t){return e[t]}.bind(null,r));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var d=s;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("cd49")},"7d8e":function(e,t,a){"use strict";a("9673")},9673:function(e,t,a){},cd49:function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-app-bar",{attrs:{app:"",color:"primary",dark:""}},[a("div",{staticClass:"d-flex align-center"},[e._v("Trivy Vulnerability Explorer")]),a("v-spacer")],1),a("v-main",[a("router-view")],1)],1)},i=[],l=r["default"].extend({name:"App",components:{},data:function(){return{}}}),o=l,c=a("2877"),s=a("6544"),u=a.n(s),d=a("7496"),p=a("40dc"),v=a("f6c4"),b=a("2fa4"),f=Object(c["a"])(o,n,i,!1,null,null,null),h=f.exports;u()(f,{VApp:d["a"],VAppBar:p["a"],VMain:v["a"],VSpacer:b["a"]});a("d3b7"),a("3ca3"),a("ddb0");var y=a("8c4f"),m=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-container",{attrs:{fluid:""}},[a("v-row",[a("v-col",[a("v-card",{attrs:{color:"#BBDEFB"}},[a("v-card-title",{staticClass:"headline"},[e._v(" Instructions")]),a("v-card-subtitle",[e._v(" Select a JSON Report from "),a("a",{attrs:{href:"https://github.com/aquasecurity/trivy",target:"_blank"}},[e._v("Trivy")]),e._v(" from your local file system. You may limit the displayed vulnerabilities to a single target. If you need, select the Vulnerabilities that you want to ignore/accept and use the .trivyignore output below for further processing in your pipeline. The data never leaves your browser, promised! ")])],1)],1)],1),a("DataInput",{attrs:{presetUrl:this.presetUrl},on:{inputChanged:e.reactivelySetNewVulnerabilities}}),a("DataTable",{attrs:{selectedVulnerabilities:e.selectedVulnerabilities}})],1)],1)},g=[],O=a("2909"),j=a("d4ec"),V=a("bee2"),x=a("257e"),w=a("262e"),S=a("2caf"),_=a("ade3"),k=(a("99af"),a("a434"),a("159b"),a("9ab4")),T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-toolbar",{staticClass:"mt-5"},[a("v-btn-toggle",{attrs:{mandatory:""},model:{value:e.reportSource,callback:function(t){e.reportSource=t},expression:"reportSource"}},[a("v-btn",{attrs:{value:e.ReportSource.File}},[e._v(" File")]),a("v-btn",{attrs:{value:e.ReportSource.Url}},[e._v(" URL")])],1),e.reportSource===e.ReportSource.File?a("VueFileAgent",{ref:"fileAgent",staticClass:"upload-block ma-2",attrs:{multiple:!1,deletable:!0,theme:"list",helpText:"Choose file",accept:"application/json",errorText:{size:"This file is too large to be attached"}},on:{select:e.onFileChange,beforedelete:e.onFileDeleted}}):e._e(),e.reportSource===e.ReportSource.Url?a("ReportUrlFetcher",{attrs:{onNewReport:e.onNewReport,presetUrl:this.presetUrl}}):e._e(),a("v-autocomplete",{attrs:{clearable:"",items:e.vulnerabilityReport,"item-text":"Target","item-value":"Target",label:"Select Target","hide-details":""},model:{value:e.selectedTarget,callback:function(t){e.selectedTarget=t},expression:"selectedTarget"}})],1)},R=[],C=(a("7db0"),a("5db7"),a("73d9"),a("4de4"),a("7924")),F=a.n(C),N=a("1b40"),A=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("fragment",[a("v-text-field",{staticClass:"mx-2",attrs:{label:"Url","hide-details":""},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}}),a("v-dialog",{attrs:{persistent:"","max-width":"600px"},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,n=t.attrs;return[a("v-btn",e._g(e._b({attrs:{color:"primary",icon:""}},"v-btn",n,!1),r),[a("v-icon",{attrs:{"aria-label":"Add Authorization Header"}},[e._v("mdi-shield-lock ")])],1)]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",[a("span",{staticClass:"text-h5"},[e._v("Authorization")])]),a("v-card-text",[a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-text-field",{attrs:{label:"Header Name"},model:{value:e.headerName,callback:function(t){e.headerName=t},expression:"headerName"}})],1),a("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[a("v-text-field",{attrs:{label:"Header Value"},model:{value:e.headerValue,callback:function(t){e.headerValue=t},expression:"headerValue"}})],1)],1),a("v-row",[a("v-col",[e._v(" The data will be stored in the localStorage of your Browser and is added as a header to the fetch call. If you want to fetch a report from a "),a("a",{attrs:{href:"https://docs.gitlab.com/ee/api/job_artifacts.html#download-a-single-artifact-file-by-job-id",target:"_blank"}},[e._v("GitLab Job")]),e._v(" , you need to add the PRIVATE-TOKEN header and set it to a "),a("a",{attrs:{href:"https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html"}},[e._v("personal access token")]),e._v(" with the scope read_api. ")])],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.saveAuthorization}},[e._v(" Save&Close ")])],1)],1)],1),a("v-btn",{staticClass:"mx-2",attrs:{loading:"loading"===this.state,disabled:"loading"===this.state||!e.url,color:"error"===this.state?"error":"primary"},on:{click:e.fetchReportFromUrl}},[e._v(" Fetch ")])],1)},U=[],I=a("1da1"),E=(a("96cf"),a("76e6")),D=r["default"].extend({props:{onNewReport:Function,presetUrl:String}});r["default"].use(F.a);var B=function(e){Object(w["a"])(a,e);var t=Object(S["a"])(a);function a(){var e;Object(j["a"])(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e=t.call.apply(t,[this].concat(n)),Object(_["a"])(Object(x["a"])(e),"url",""),Object(_["a"])(Object(x["a"])(e),"state","ready"),Object(_["a"])(Object(x["a"])(e),"dialog",!1),Object(_["a"])(Object(x["a"])(e),"headerName",""),Object(_["a"])(Object(x["a"])(e),"headerValue",""),e}return Object(V["a"])(a,[{key:"mounted",value:function(){this.loadAuthorization(),this.presetUrl&&(this.url=this.presetUrl,this.fetchReportFromUrl())}},{key:"loadAuthorization",value:function(){this.headerName=localStorage.getItem("headerName")||"",this.headerValue=localStorage.getItem("headerValue")||""}},{key:"saveAuthorization",value:function(){localStorage.setItem("headerName",this.headerName),localStorage.setItem("headerValue",this.headerValue),this.dialog=!1}},{key:"fetchReportFromUrl",value:function(){var e=Object(I["a"])(regeneratorRuntime.mark((function e(){var t,a,r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.url){e.next=21;break}return this.state="loading",t={},this.headerName&&this.headerValue&&(t[this.headerName]=this.headerValue),e.prev=4,e.next=7,fetch(this.url,{headers:t});case 7:if(a=e.sent,this.state="ready",r=a.headers.get("content-type"),!a.ok||!r||-1===r.indexOf("application/json")){e.next=16;break}return e.next=13,a.json();case 13:return n=e.sent,this.onNewReport(n),e.abrupt("return");case 16:e.next=20;break;case 18:e.prev=18,e.t0=e["catch"](4);case 20:this.state="error";case 21:case"end":return e.stop()}}),e,this,[[4,18]])})));function t(){return e.apply(this,arguments)}return t}()}]),a}(D);B=Object(k["a"])([Object(N["a"])({components:{Fragment:E["a"]}})],B);var P,L,M=B,z=M,$=a("8336"),H=a("b0af"),J=a("99d9"),q=a("62ad"),G=a("a523"),K=a("169a"),W=a("132d"),Y=a("0fd9"),Q=a("8654"),X=Object(c["a"])(z,A,U,!1,null,null,null),Z=X.exports;u()(X,{VBtn:$["a"],VCard:H["a"],VCardActions:J["a"],VCardText:J["c"],VCardTitle:J["d"],VCol:q["a"],VContainer:G["a"],VDialog:K["a"],VIcon:W["a"],VRow:Y["a"],VSpacer:b["a"],VTextField:Q["a"]}),function(e){e[e["File"]=0]="File",e[e["Url"]=1]="Url"}(L||(L={})),r["default"].use(F.a);var ee=P=function(e){Object(w["a"])(a,e);var t=Object(S["a"])(a);function a(){var e;Object(j["a"])(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e=t.call.apply(t,[this].concat(n)),Object(_["a"])(Object(x["a"])(e),"selectedTarget",""),Object(_["a"])(Object(x["a"])(e),"reportSource",L.File),Object(_["a"])(Object(x["a"])(e),"ReportSource",L),Object(_["a"])(Object(x["a"])(e),"presetUrl",void 0),Object(_["a"])(Object(x["a"])(e),"fileAgent",void 0),Object(_["a"])(Object(x["a"])(e),"file",{}),Object(_["a"])(Object(x["a"])(e),"vulnerabilityReport",[{Target:"test",Type:"type"}]),e}return Object(V["a"])(a,[{key:"mounted",value:function(){this.presetUrl&&(this.reportSource=L.Url)}},{key:"selectedVulnerabilities",get:function(){var e,t=this;return this.selectedTarget?null===(e=this.vulnerabilityReport.find((function(e){return e.Target===t.selectedTarget})))||void 0===e?void 0:e.Vulnerabilities:this.vulnerabilityReport.filter((function(e){return e.Vulnerabilities})).flatMap((function(e){return e.Vulnerabilities}))}},{key:"onNewTarget",value:function(){this.$emit("inputChanged",this.selectedVulnerabilities)}},{key:"parseFile",value:function(e){var t,a;if(null!==e&&void 0!==e&&null!==(t=e.target)&&void 0!==t&&t.result&&"string"===typeof e.target.result){var r=JSON.parse(e.target.result);a=this.extractTargetsFromReport(r)}return a}},{key:"extractTargetsFromReport",value:function(e){var t;return t=P.isSchemaVersion2(e)?e.Results:e,t.forEach((function(e){var t;return null===(t=e.Vulnerabilities)||void 0===t?void 0:t.forEach((function(t){return t.Target=e.Target}))})),t}},{key:"onFileDeleted",value:function(e){this.fileAgent.deleteFileRecord(e)}},{key:"onFileChange",value:function(e){var t=this,a=e[0],r=new FileReader;r.onload=function(e){var a=t.parseFile(e);a&&t.handleNewReport(a)},r.readAsText(a.file)}},{key:"onNewReport",value:function(e){var t=this.extractTargetsFromReport(e);this.handleNewReport(t)}},{key:"handleNewReport",value:function(e){var t;this.vulnerabilityReport.splice(0),(t=this.vulnerabilityReport).push.apply(t,Object(O["a"])(e)),this.onNewTarget()}}],[{key:"isSchemaVersion2",value:function(e){return!Array.isArray(e)&&e.SchemaVersion>=2}}]),a}(r["default"]);Object(k["a"])([Object(N["b"])()],ee.prototype,"presetUrl",void 0),Object(k["a"])([Object(N["c"])()],ee.prototype,"fileAgent",void 0),Object(k["a"])([Object(N["d"])("selectedTarget")],ee.prototype,"onNewTarget",null),Object(k["a"])([Object(N["d"])("file")],ee.prototype,"onFileChange",null),ee=P=Object(k["a"])([Object(N["a"])({components:{ReportUrlFetcher:Z}})],ee);var te=ee,ae=te,re=(a("7d8e"),a("c6a6")),ne=a("a609"),ie=a("71d9"),le=Object(c["a"])(ae,T,R,!1,null,"3cd78645",null),oe=le.exports;u()(le,{VAutocomplete:re["a"],VBtn:$["a"],VBtnToggle:ne["a"],VToolbar:ie["a"]});var ce=function(){var e=this,t=this,a=t.$createElement,r=t._self._c||a;return r("span",[r("v-text-field",{staticClass:"mb-10 mt-5",attrs:{"append-icon":"mdi-magnify",label:"Search","single-line":"",outlined:"","hide-details":""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),r("v-tabs",{attrs:{dark:"","background-color":"primary",grow:"","hide-slider":"","show-arrows":""}},[r("v-tab",{on:{click:function(e){t.search=""}}},[t._v("Total: "+t._s(t.vulnerabilityStats.total)+" ")]),r("v-tab",{on:{click:function(e){t.search=""}}},[t._v("Fixable: "+t._s(t.vulnerabilityStats.fixable))]),t._l(t.vulnerabilityStats.severityInformation,(function(e){return r("v-tab",{key:e.severity,on:{click:function(a){t.search=e.severity}}},[t._v(" "+t._s(e.severity)+": "+t._s(e.count)+" ")])}))],2),r("v-data-table",{staticClass:"elevation-1 mb-10",attrs:{dense:"","show-select":"",headers:t.headers,"items-per-page":20,items:t.selectedVulnerabilities,"item-key":"id","show-expand":"","single-expand":"","sort-by":t.sortBy,search:t.search,expanded:t.expanded},on:{"update:expanded":function(e){t.expanded=e}},scopedSlots:t._u([{key:"expanded-item",fn:function(e){var a=e.headers,n=e.item;return[r("td",{attrs:{colspan:a.length}},[r("h3",[t._v(t._s(n.Title))]),r("p",[t._v(t._s(n.Description))]),r("p",[r("a",{attrs:{href:n.PrimaryURL}},[t._v(t._s(n.PrimaryURL))])])])]}}]),model:{value:t.ignoredVulnerabilities,callback:function(e){t.ignoredVulnerabilities=e},expression:"ignoredVulnerabilities"}}),r("v-btn",{directives:[{name:"clipboard",rawName:"v-clipboard",value:function(){return e.ignoredCves},expression:"() => this.ignoredCves"}],staticClass:"mb-5",attrs:{color:"primary"}},[t._v(" Copy .trivyignore to Clipboard ")]),r("v-textarea",{attrs:{outlined:"",label:".trivyignore",value:t.ignoredCves,readonly:""}})],1)},se=[],ue=(a("d81d"),a("a630"),a("6062"),a("4e827"),a("a15b"),a("4ae6")),de=a.n(ue);r["default"].use(de.a);var pe=function(e){Object(w["a"])(a,e);var t=Object(S["a"])(a);function a(){var e;Object(j["a"])(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e=t.call.apply(t,[this].concat(n)),Object(_["a"])(Object(x["a"])(e),"selectedVulnerabilities",void 0),Object(_["a"])(Object(x["a"])(e),"ignoredVulnerabilities",[]),Object(_["a"])(Object(x["a"])(e),"expanded",[]),Object(_["a"])(Object(x["a"])(e),"sortBy","Severity"),Object(_["a"])(Object(x["a"])(e),"search",""),Object(_["a"])(Object(x["a"])(e),"severitySortOrder",{CRITICAL:0,HIGH:1,MEDIUM:2,LOW:3,UNKNOWN:4}),Object(_["a"])(Object(x["a"])(e),"headers",[{text:"Target",value:"Target"},{text:"PkgName",value:"PkgName"},{text:"VulnerabilityID",value:"VulnerabilityID"},{value:"Severity",text:"Severity",sort:e.compareBySeverity},{text:"InstalledVersion",value:"InstalledVersion"},{text:"FixedVersion",value:"FixedVersion"}]),e}return Object(V["a"])(a,[{key:"ignoredCves",get:function(){var e=this,t=Array.from(new Set(this.ignoredVulnerabilities.map((function(e){return e.VulnerabilityID})))).map((function(t){return e.ignoredVulnerabilities.find((function(e){return e.VulnerabilityID===t}))})),a=[];return t.sort((function(t,a){return e.compareBySeverity(t.Severity,a.Severity)})),null===t||void 0===t||t.forEach((function(e){a.push("# ".concat(e.Severity,": ").concat(e.Title)),a.push(e.VulnerabilityID)})),a.join("\n")}},{key:"vulnerabilityStats",get:function(){var e=this,t=this.selectedVulnerabilities.length,a=this.selectedVulnerabilities.filter((function(e){return void 0!=e.FixedVersion})).length,r=Object(O["a"])(new Set(this.selectedVulnerabilities.map((function(e){return e.Severity})))),n=r.map((function(t){return{severity:t,count:e.selectedVulnerabilities.filter((function(e){return e.Severity===t})).length}})).sort((function(t,a){return e.compareBySeverity(t.severity,a.severity)}));return{total:t,fixable:a,severityInformation:n}}},{key:"compareBySeverity",value:function(e,t){return this.severitySortOrder[e]-this.severitySortOrder[t]}}]),a}(r["default"]);Object(k["a"])([Object(N["b"])({required:!0})],pe.prototype,"selectedVulnerabilities",void 0),pe=Object(k["a"])([N["a"]],pe);var ve=pe,be=ve,fe=a("8fea"),he=a("71a3"),ye=a("fe57"),me=a("a844"),ge=Object(c["a"])(be,ce,se,!1,null,"4296151c",null),Oe=ge.exports;u()(ge,{VBtn:$["a"],VDataTable:fe["a"],VTab:he["a"],VTabs:ye["a"],VTextField:Q["a"],VTextarea:me["a"]});var je=function(e){Object(w["a"])(a,e);var t=Object(S["a"])(a);function a(){var e;Object(j["a"])(this,a);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e=t.call.apply(t,[this].concat(n)),Object(_["a"])(Object(x["a"])(e),"presetUrl",void 0),Object(_["a"])(Object(x["a"])(e),"selectedVulnerabilities",[]),e}return Object(V["a"])(a,[{key:"reactivelySetNewVulnerabilities",value:function(e){var t;this.selectedVulnerabilities.splice(0),e.forEach((function(e,t){return e.id=t})),(t=this.selectedVulnerabilities).push.apply(t,Object(O["a"])(e))}}]),a}(r["default"]);Object(k["a"])([Object(N["b"])()],je.prototype,"presetUrl",void 0),je=Object(k["a"])([Object(N["a"])({components:{DataTable:Oe,DataInput:oe}})],je);var Ve=je,xe=Ve,we=Object(c["a"])(xe,m,g,!1,null,null,null),Se=we.exports;u()(we,{VCard:H["a"],VCardSubtitle:J["b"],VCardTitle:J["d"],VCol:q["a"],VContainer:G["a"],VRow:Y["a"]}),r["default"].use(y["a"]);var _e=[{path:"/",name:"Home",component:Se,props:function(e){return{presetUrl:e.query.url}}},{path:"/about",name:"About",component:function(){return a.e("about").then(a.bind(null,"f820"))}}],ke=new y["a"]({base:"",routes:_e}),Te=ke,Re=a("f309");r["default"].use(Re["a"]);var Ce=new Re["a"]({});r["default"].config.productionTip=!1,new r["default"]({router:Te,data:{vulnerabilities:void 0},vuetify:Ce,render:function(e){return e(h)}}).$mount("#app")}});
//# sourceMappingURL=app.d6a4fd96.js.map